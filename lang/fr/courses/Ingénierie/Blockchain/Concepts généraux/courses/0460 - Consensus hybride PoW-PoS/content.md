Le mécanisme de consensus d'une blockchain sert à garantir qu'il existe un accord entre les participants sur l'état actuel de la blockchain. Le mécanisme de consensus détermine qui est en mesure d'ajouter de nouveaux blocs de transactions, et l'un de ses principaux objectifs est de veiller à ce que la chaîne ne soit pas réécrite.

## Consensus sur la preuve de travail

Les blockchains avec un consensus pur par preuve de travail (comme le bitcoin) ne peuvent avoir de nouveaux blocs ajoutés que par des mineurs, qui déploient du matériel qui devine efficacement la réponse à un problème mathématique. Chaque fois qu'un mineur fait une estimation valide, il peut construire un bloc que le réseau accepte. Bien que les mineurs puissent choisir de miner n'importe quelle chaîne, le réseau n'acceptera que la chaîne ayant accumulé le plus de preuves de travail (c'est-à-dire le plus de hachages ou de suppositions) comme chaîne légitime. Cela signifie que les mineurs sont incités à miner sur la chaîne la plus longue, et lorsqu'ils voient un nouveau bloc valide, ils essaient de trouver la solution pour le bloc suivant qui leur permet de construire sur le bloc précédent.

La difficulté de réécrire la blockchain est ce qui lui permet de fonctionner comme un grand livre de comptes pour les transactions financières. Lorsqu'une transaction apparaît dans un bloc qui envoie des pièces à un portefeuille, et que plusieurs blocs ont été construits au-dessus de ce bloc (confirmations), il devient peu probable que le bloc (et la transaction) soit réécrit.

Si une entité contrôle une puissance de hachage suffisante pour dépasser la "chaîne honnête", elle peut réécrire (ou réorganiser) la blockchain en exploitant un "ancien" bloc au lieu du dernier. Voici un compte rendu simplifié de ce type d'attaque, également connu sous le nom d'attaque 51% :

L'attaquant dépense dans le bloc X en envoyant à un échange, puis commence à miner une chaîne parallèle en privé (les blocs ne sont pas diffusés sur le réseau). Une fois que le nombre requis de confirmations est passé, l'attaquant échange les pièces contre autre chose et les retire de la bourse. Lorsque le retrait est autorisé, il libère la chaîne parallèle, et si elle a plus de blocs que la chaîne originale, le réseau l'acceptera comme la chaîne légitime et la version de l'histoire représentée par la chaîne originale (y compris le dépôt de l'attaquant) disparaîtra. L'attaquant est alors libre de dépenser à nouveau ces pièces.

Comme les mineurs sont les seules entités qui peuvent ajouter directement des blocs à la chaîne dans les crypto-monnaies PoW pures, cela leur confère un rôle important dans la gouvernance. Pour qu'une modification des règles de consensus du réseau soit adoptée, elle doit avoir le soutien d'une majorité de puissance de hachage. Les "soft forks" nécessitent qu'un nombre suffisant de mineurs reconnaissent un nouvel ensemble de règles pour que les utilisateurs puissent effectuer des transactions et s'attendre à ce que celles-ci soient correctement traitées et incluses dans les blocs. Les "hard forks" diviseraient le réseau en deux composantes et, selon la règle communément admise selon laquelle "la chaîne ayant le plus de PoW est la bonne chaîne à suivre", les mineurs décideraient laquelle est acceptée comme légitime.

## Consensus de preuve d'enjeu

Le consensus Proof of Stake est une méthode alternative pour décider qui peut ajouter de nouveaux blocs et vérifier l'état actuel de la blockchain. Au lieu que les mineurs soient en concurrence pour résoudre un problème, avec la preuve d'enjeu, le prochain producteur de blocs est déterminé par un processus basé sur le nombre de pièces détenues dans les portefeuilles (ou "mises"). Ce processus fait confiance à ceux qui ont le plus d'enjeux pour prendre des décisions responsables pour l'ensemble du réseau.

Le consensus de preuve d'enjeu élimine la nécessité d'un minage à forte intensité énergétique, mais l'absence de dépenses énergétiques significatives crée un autre problème, parfois appelé "absence d'enjeu". Dans le cas d'une chaîne bifurquée, les forgeurs de PoS ("forgeage" est généralement utilisé à la place de "minage") sont incités à valider des blocs sur les deux chaînes car cela leur coûte très peu de travailler sur une chaîne supplémentaire et ils peuvent collecter des récompenses sur les deux chaînes. C'est un problème pour le réseau, car il n'est censé y avoir qu'une seule chaîne et l'accord sur l'état de cette chaîne unique est l'objectif même du mécanisme de consensus.

La méthode Proof of Stake pose un problème supplémentaire en ce qui concerne la distribution des jetons. Les mineurs de PoW ont des coûts importants (matériel, électricité) et doivent généralement vendre une partie importante de leurs pièces minées pour couvrir ces coûts. Par conséquent, de nombreuses pièces minées sont disponibles à l'achat sur le marché, plutôt que d'être thésaurisées par les mineurs. Les forgeurs de Proof of Stake ont des coûts d'exploitation très bas, et n'ont donc pas la même pression pour vendre les pièces qu'ils reçoivent pour maintenir le réseau. Les grands détenteurs qui s'engagent dans la Proof of Stake ont tendance à augmenter leur part des pièces en circulation à mesure qu'ils perçoivent les récompenses de bloc et les frais de transaction des utilisateurs du réseau. Ce système a été comparé au féodalisme, dans lequel le réseau est effectivement détenu et exploité par les détenteurs de pièces, et les utilisateurs leur versent une sorte de loyer pour l'utiliser. Il existe généralement un seuil en dessous duquel il n'est pas possible de participer directement à la Proof of Stake.

## PoW/PoS hybride

L'objectif des systèmes hybrides Proof of Work et Proof of Stake est de capturer les avantages des approches respectives et de les utiliser pour équilibrer leurs faiblesses respectives. Decred est l'une des rares crypto-monnaies à utiliser à la fois PoW et PoS sous des formes reconnaissables et à les fusionner pour produire un mécanisme de consensus multifactoriel ou hybride.

Les "Masternode coins" sont, dans un certain sens, également des hybrides, dans la mesure où ils ont un composant de preuve de travail reconnaissable qui joue un rôle similaire à celui du Bitcoin, et un rôle supplémentaire pour des nœuds spéciaux. Il est généralement exigé que ces nœuds spéciaux détiennent une certaine quantité de la monnaie comme garantie, afin de démontrer qu'ils peuvent être sûrs d'agir dans les meilleurs intérêts du réseau, ce qui est similaire à la logique de la preuve d'enjeu. Dash est la pièce masternode originale et fait référence à ce modèle en tant que Proof of Service. Cet article se concentre sur les hybrides avec un composant Proof of Stake, et n'examinera pas l'ensemble des pièces qui émulent les masternodes ou Proof of Service.

Le composant PoW de Decred fonctionne comme les autres projets basés sur le PoW et utilise la fonction de hachage Blake-256. Le composant PoS de Decred, et la façon dont il est intégré à la chaîne, est tout à fait unique et mérite d'être expliqué.

Pour participer à la Proof of Stake de Decred, les détenteurs doivent verrouiller leur DCR pour acheter des "tickets". Le prix d'un billet individuel est fixé par un mécanisme semblable à celui du marché, selon lequel le système vise un nombre déterminé de billets en direct (40 960) - s'il y en a plus que le nombre cible, le prix augmente, s'il y en a moins, il diminue. Lorsque quelqu'un achète un ticket, le DCR qu'il a utilisé est verrouillé (c'est-à-dire qu'il ne peut pas le dépenser) jusqu'à ce que son ticket soit appelé pseudo-aléatoirement à voter, ou jusqu'à ce qu'il expire après environ 142 jours. Cela introduit un coût d'opportunité pour le PoS, destiné à garantir que les votants du PoS ont leur peau dans le jeu et agissent dans le meilleur intérêt du réseau.

Les participants au PoS (également appelés votants ou parties prenantes) ont trois rôles distincts à jouer : le vote en bloc, le vote sur les modifications des règles de consensus, et le vote sur la gestion au niveau du projet en utilisant le système de proposition Politeia. Le premier de ces rôles, le "vote en bloc", est la façon dont les votants du PoS s'engagent le plus directement dans le maintien du consensus.

## Vote sur les blocs

Lorsqu'un mineur PoW trouve un bloc valide, il le diffuse sur le réseau, mais pour que ce bloc soit considéré comme valide, il doit inclure les votes d'au moins 3 des 5 tickets sélectionnés au hasard. Les votants PoS gardent leurs portefeuilles ouverts et sont prêts à répondre avec des votes lorsque leurs tickets sont appelés (ou ils engagent des fournisseurs de services de vote pour le faire en leur nom). Lorsqu'un ticket PoS est appelé à voter et répond, son propriétaire reçoit une récompense.

Lorsque les tickets sont appelés, ils votent pour accepter ou rejeter les transactions régulières du bloc précédent. Les nœuds du réseau ne reconnaîtront pas un nouveau bloc comme valide tant qu'il ne comprend pas au moins 3 votes. Si une majorité des tickets appelés à voter rejette les transactions du bloc précédent, celles-ci sont renvoyées dans le pool de mémoire. Ces transactions régulières incluent la récompense du mineur PoW, mais pas la récompense des votants PoS. 

Par conséquent, les électeurs PoS ont le pouvoir de retirer les récompenses des mineurs sans affecter leurs propres récompenses. Cela limite le pouvoir des mineurs de PoW d'opposer leur veto aux modifications des règles de consensus du réseau, qui sont votées par les parties prenantes. En fait, les électeurs PoS peuvent rejeter tout type de comportement de mineur qui leur déplaît en adoptant une politique de vote "non" lorsqu'un comportement malveillant ou inefficace est détecté - empêchant les mauvais mineurs PoW d'écrire des transactions et de recevoir des récompenses.

Cette couche de vérification PoS renforce considérablement la sécurité du réseau et sa résistance aux attaques majoritaires. La méthode courante pour mener une attaque majoritaire par double dépense consiste à réécrire la blockchain en minant une autre chaîne en secret, puis en la libérant après un certain temps et en profitant de l'annulation des transactions dans l'"ancienne" chaîne (c'est-à-dire en dépensant deux fois leurs entrées). Étant donné que les blocs Decred nécessitent l'entrée de billets sélectionnés au hasard pour être considérés comme valides et qu'ils ne peuvent pas être construits par les mineurs PoW tant qu'ils n'ont pas reçu cette entrée, il n'est pas possible pour les mineurs PoW de miner en secret à moins qu'ils ne contrôlent également une proportion importante des billets vivants (voir ces articles). 

La conception hybride PoW/PoS augmente considérablement les coûts d'attaque du réseau car il y a deux systèmes distincts qui doivent être contournés par un attaquant. Le composant PoS, en particulier, est configuré de telle sorte que les tickets ne peuvent être acquis que très lentement. Un nombre limité de billets peut être acheté dans chaque bloc/intervalle, et l'achat du nombre maximum entraîne une forte augmentation du prix. En outre, une fois que ces billets ont été achetés, les fonds utilisés pour les acheter sont bloqués dans le temps, ce qui expose un attaquant à toute dévaluation de ses pièces bloquées résultant d'une attaque.

L'exigence selon laquelle chaque bloc est voté par des parties prenantes choisies au hasard signifie que la blockchain doit être partagée avec tous les participants au fur et à mesure qu'elle est minée, ce qui renforce la sécurité du réseau. Le système hybride de Decred a été conçu pour donner aux parties prenantes le pouvoir sur les mineurs PoW.

## Vote de changement par consensus

Decred a décidé dès le départ de faire des parties prenantes PoS la force de décision dominante dans la gouvernance de la blockchain. Les règles de consensus prévoient une procédure de ratification des mises à jour, par laquelle toute modification des règles de consensus du réseau ne peut être déployée qu'après avoir été soumise à un processus de vote. Les changements ne peuvent être effectués que s'ils sont approuvés par au moins 75 % des tickets de vote. Ce processus commence dès qu'une certaine proportion de mineurs (95 %) et de votants (75 %) utilisent un logiciel mis à jour avec des modifications latentes des règles. Si la proposition a 75% de soutien après une période de vote de 4 semaines, elle est acceptée, sinon, elle est rejetée, et si elle n'a pas la supermajorité, un nouveau vote commence. Si une proposition est acceptée, le changement de règle est activé un mois plus tard.

## Gestion de projet : Politeia

Les récompenses en blocs de Decred sont réparties entre les mineurs PoW (60 %), les électeurs PoS (30 %) et un Trésor (10 %) pour financer le développement de logiciels open source qui servent les objectifs du projet. Les détenteurs de tickets sont souverains pour voter sur la manière dont ce fonds doit être dépensé, sur les fonctionnalités à ajouter, et pour déterminer la politique à travers la plateforme Politeia.

## Conclusion

Comme les votants PoS reçoivent 30% de la récompense du bloc, ils ne peuvent pas maintenir leur part relative de DCR en circulation simplement en jalonnant. La majorité des DCR nouvellement frappés vont aux mineurs de PoW en échange du rôle qu'ils jouent dans la sécurisation du réseau et l'atténuation du problème du "rien en jeu" des systèmes de PoS purs. Les mineurs devraient généralement vendre une partie importante des récompenses qu'ils reçoivent pour couvrir leurs coûts opérationnels, ce qui garantit la disponibilité d'une offre équitable de DCR sur le marché.

La blockchain de Decred présente une architecture unique et constitue l'un des exemples les plus remarquables de système hybride PoW/PoS. De la même manière que les projets avec consensus PoS sont un groupe général avec des variations significatives à l'intérieur, les projets futurs qui déploient des approches hybrides PoW/PoS seront également uniques et ne suivront pas nécessairement le cadre de Decred.